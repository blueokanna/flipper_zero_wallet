========================================
RIPEMD-160 和 Keccak-256 测试向量
========================================

RIPEMD-160 官方测试向量
========================

1. 空字符串
   输入: ""
   期望输出: 9c1185a5c5e9fc54612808977ee8f548b2258d31
   说明: 160位空哈希

2. "abc"
   输入: "abc"
   期望输出: 8eb208f7e05d987a9b044a8e98ad0ead7a7a7904
   说明: 标准短字符串

3. "The quick brown fox jumps over the lazy dog"
   输入: "The quick brown fox jumps over the lazy dog"
   期望输出: 37f332f68db77bd9d7edd4969571ad671cf9dd3b
   说明: 标准长短语测试

4. "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"
   输入: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"
   期望输出: b0e20b6e3116eaf0c56b82c9934552785c1d1de3
   说明: 所有字母数字字符

5. "aaaa...aaaa" (100万个 'a')
   输入: 1000000 x 'a'
   期望输出: 52783243c1697bdbe16d37e6ce3b02ff72030d60
   说明: 大型输入测试


Keccak-256 官方测试向量
========================

1. 空字符串
   输入: ""
   期望输出: c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470
   说明: 256位空哈希

2. "abc"
   输入: "abc"
   期望输出: 4e4711385f56236cdc0e1b9ff38552bd885bf27f10cf1962762c680b59e899b41
   说明: 标准短字符串

3. Ethereum 传统测试
   输入: 64个 0x00 字节（未压缩公钥示例）
   期望输出: (取决于具体公钥)
   说明: Ethereum 地址生成示例


验证步骤
========

对于 Rust 实现验证，可以创建 Rust 测试，如下所示：

#[test]
fn test_ripemd160_vectors() {
    assert_eq!(
        Ripemd160::digest(b""),
        [0x9c, 0x11, 0x85, 0xa5, ..., 0x31]
    );
    
    assert_eq!(
        Ripemd160::digest(b"abc"),
        [0x8e, 0xb2, 0x08, 0xf7, ..., 0x04]
    );
}

#[test]
fn test_keccak256_vectors() {
    assert_eq!(
        Keccak256::digest(b""),
        [0xc5, 0xd2, 0x46, 0x01, ..., 0x70]
    );
    
    assert_eq!(
        Keccak256::digest(b"abc"),
        [0x4e, 0x47, 0x11, 0x38, ..., 0x41]
    );
}


使用官方参考库验证
===================

Python 中验证:
    pip install pycryptodome
    from Crypto.Hash import RIPEMD160, keccak
    
    h = RIPEMD160.new()
    h.update(b"abc")
    print(h.hexdigest())  # 8eb208f7e05d987a9b044a8e98ad0ead7a7a7904
    
    k = keccak.new(digest_bits=256)
    k.update(b"abc")
    print(k.hexdigest())  # 4e4711385f56236cdc0e1b9ff38552bd885bf27f10cf1962762c680b59e899b41

JavaScript 中验证:
    npm install js-sha3 ripemd160
    
    const keccak256 = require('js-sha3').keccak256;
    const ripemd160 = require('ripemd160');
    
    console.log(keccak256('abc'));      // 4e4711385f56236cdc0e1b9ff38552bd885bf27f10cf1962762c680b59e899b41
    console.log(new ripemd160().update('abc').digest('hex'));  // 8eb208f7e05d987a9b044a8e98ad0ead7a7a7904

在线工具验证:
    https://emn178.github.io/online-tools/keccak_256.html
    https://emn178.github.io/online-tools/ripemd160.html


Bitcoin 地址生成验证
=====================

使用 BIP32 导出的私钥生成地址，然后与以下工具对比:
    - Blockchain.com 钱包
    - Bitcoin Core
    - Electrum 钱包
    
步骤:
1. 从 BIP39 助记词导出种子
2. 从种子导出根私钥（BIP32）
3. 导出公钥
4. SHA256(公钥) -> RIPEMD160 -> 添加版本字节 -> Base58Check
5. 对比官方钱包地址


Ethereum 地址生成验证
=====================

使用 BIP44 导出的私钥生成地址，然后与以下工具对比:
    - MetaMask
    - MyEtherWallet
    - Etherscan 地址检查器
    
步骤:
1. 从 BIP39 助记词导出种子
2. 从种子导出根私钥（BIP32）
3. 通过 BIP44 导出 Ethereum 路径 (m/44'/60'/0'/0/0)
4. 导出公钥（未压缩）
5. Keccak256(公钥[1:65]) -> 取最后 20 字节 -> "0x" + hex
6. 对比官方钱包地址


预期结果
========

✅ RIPEMD-160: 输出应完全匹配上述测试向量（40 字符十六进制）
✅ Keccak-256: 输出应完全匹配上述测试向量（64 字符十六进制）
✅ Bitcoin 地址: 应与 Blockchain.com 钱包生成的地址相同
✅ Ethereum 地址: 应与 MetaMask 或 MyEtherWallet 生成的地址相同

如果不匹配，检查:
1. 字节序（大端序 vs 小端序）
2. 轮常数和旋转金额表
3. 块大小和填充
4. 模运算和 modular inverse

========================================
